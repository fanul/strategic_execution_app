<!DOCTYPE html>
<html lang="en">
<head>

    <?!= headerTitle ?>
    <?!= linkReel ?>
    <?!= minimalStyle ?>

</head>
<body>

    <!-- REMOVED: Old loading overlay (now using inline loading in AJAX navigation) -->

    <div class="container-fluid">
        <div class="row">
            
            <!-- Sidebar -->
            <?!= sidebar ?>
            <!-- END OF Sidebar -->

            <!-- Main Content -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 pt-4">
                <div id="main-content">
                    <?!= pageContent ?>
                </div>
            </main>
        </div>
    </div>

    <?!= toasts ?>

    <!-- Page-specific modals container -->
    <div id="page-modals">
        <?!= pageModals ?>
    </div>

    <!-- Debug Panel (Hidden by default, visibility controlled by settings) -->
    <div id="debugPanel" class="debug-panel" style="display:none;">
        <div class="debug-header">
            <span>Debug Logs</span>
            <div>
                <button class="btn btn-sm btn-outline-light" onclick="debugPanel.clear()">Clear</button>
                <button class="btn btn-sm btn-outline-light" onclick="debugPanel.download()">Download</button>
                <button class="btn btn-sm btn-outline-light" onclick="debugPanel.toggle()">âœ•</button>
            </div>
        </div>
        <div id="debugLogs" class="debug-logs"></div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap5.min.js"></script>
    <!-- Select2 CSS & JS for searchable dropdowns -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/select2-bootstrap-5-theme@1.3.0/dist/select2-bootstrap-5-theme.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

    <!-- Script Loading Tracker -->
    <script>
        window.scriptLoadTracker = window.scriptLoadTracker || {
            scripts: [],
            log: function(scriptName, status) {
                const timestamp = new Date().toISOString();
                const entry = `[${timestamp}] ${status}: ${scriptName}`;
                this.scripts.push(entry);
                console.log(entry);
                // Also try to log to DOM if available
                if (window.debugLog) {
                    window.debugLog('LOAD', `${status}: ${scriptName}`);
                }
            },
            loaded: function(scriptName) {
                this.log(scriptName, 'LOADED');
            },
            error: function(scriptName, error) {
                this.log(scriptName, 'ERROR - ' + error);
                console.error('Script loading error:', scriptName, error);
            }
        };
        console.log('=== SCRIPT LOADING TRACKER INITIALIZED ===');
    </script>

    <?!= debug_panel_script ?>

    <?!= api_helper ?>
    <?!= ui_helpers ?>
    <?!= modals ?>
    <?!= settings_manager ?>
    <?!= ajax_loader ?>
    <?!= router ?>
    <?!= pageScripts ?>

</body>
</html>
