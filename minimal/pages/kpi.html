<div id="kpi-view" class="view-section active">
    <!-- Page Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="mb-1">KPI Management</h2>
            <p class="text-muted mb-0">Organizational and Individual Key Performance Indicators</p>
        </div>
        <div class="btn-group">
            <button class="btn btn-primary" onclick="showModal('org-kpi')">
                <i class="bi bi-plus-circle me-2"></i>Add Organizational KPI
            </button>
            <button class="btn btn-success" onclick="showModal('ind-kpi')">
                <i class="bi bi-person-badge me-2"></i>Add Individual KPI
            </button>
        </div>
    </div>

    <!-- View Toggle -->
    <div class="card mb-4">
        <div class="card-body">
            <div class="btn-group" role="group">
                <button type="button" class="btn btn-outline-primary" id="org-kpi-view-btn" onclick="switchView('org-kpi')">
                    <i class="bi bi-building me-2"></i>Organizational KPIs
                </button>
                <button type="button" class="btn btn-outline-primary" id="ind-kpi-view-btn" onclick="switchView('ind-kpi')">
                    <i class="bi bi-person me-2"></i>Individual KPIs
                </button>
            </div>
        </div>
    </div>

    <!-- Filters -->
    <div class="card mb-4">
        <div class="card-body">
            <div class="row g-3">
                <div class="col-md-3">
                    <label class="form-label">Perspective</label>
                    <select class="form-select" id="kpiPerspectiveFilter" onchange="KPIManager.filterKPIs()">
                        <option value="">All Perspectives</option>
                        <option value="financial">Financial</option>
                        <option value="customer">Customer</option>
                        <option value="internal_process">Internal Process</option>
                        <option value="learning_growth">Learning & Growth</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label">Work Unit</label>
                    <select class="form-select" id="kpiWorkUnitFilter" onchange="KPIManager.filterKPIs()">
                        <option value="">All Work Units</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label">Status</label>
                    <select class="form-select" id="kpiStatusFilter" onchange="KPIManager.filterKPIs()">
                        <option value="">All Status</option>
                        <option value="on_track">On Track (â‰¥90%)</option>
                        <option value="at_risk">At Risk (70-90%)</option>
                        <option value="off_track">Off Track (<70%)</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label">Year</label>
                    <select class="form-select" id="kpiYearFilter" onchange="KPIManager.filterKPIs()">
                        <option value="">All Years</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <!-- Organizational KPIs View -->
    <div id="org-kpi-view">
        <div class="card">
            <div class="card-header">
                <div class="d-flex justify-content-between align-items-center">
                    <h5 class="mb-0"><i class="bi bi-graph-up me-2"></i>Organizational KPIs</h5>
                    <button class="btn btn-sm btn-outline-secondary" onclick="KPIManager.loadOrgKPIs()">
                        <i class="bi bi-arrow-clockwise"></i> Refresh
                    </button>
                </div>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table id="orgKpiTable" class="table table-hover w-100">
                        <thead>
                            <tr>
                                <th>Code</th>
                                <th>Name</th>
                                <th>Perspective</th>
                                <th>Work Unit</th>
                                <th>Target</th>
                                <th>Current</th>
                                <th>Achievement %</th>
                                <th>Status</th>
                                <th width="120">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="10" class="text-center">Loading KPIs...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- KPI Scorecard Summary -->
        <div class="card mt-4">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-speedometer2 me-2"></i>Performance Scorecard</h5>
            </div>
            <div class="card-body">
                <div id="kpiScorecard">
                    <div class="row text-center">
                        <div class="col-md-3">
                            <div class="card bg-success text-white">
                                <div class="card-body">
                                    <h3 id="onTrackCount">-</h3>
                                    <small>On Track</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-warning text-white">
                                <div class="card-body">
                                    <h3 id="atRiskCount">-</h3>
                                    <small>At Risk</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-danger text-white">
                                <div class="card-body">
                                    <h3 id="offTrackCount">-</h3>
                                    <small>Off Track</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-info text-white">
                                <div class="card-body">
                                    <h3 id="avgAchievement">-</h3>
                                    <small>Avg Achievement</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Individual KPIs View -->
    <div id="ind-kpi-view" style="display: none;">
        <div class="card">
            <div class="card-header">
                <div class="d-flex justify-content-between align-items-center">
                    <h5 class="mb-0"><i class="bi bi-person-badge me-2"></i>Individual KPIs</h5>
                    <button class="btn btn-sm btn-outline-secondary" onclick="KPIManager.loadIndKPIs()">
                        <i class="bi bi-arrow-clockwise"></i> Refresh
                    </button>
                </div>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table id="indKpiTable" class="table table-hover w-100">
                        <thead>
                            <tr>
                                <th>Code</th>
                                <th>Name</th>
                                <th>Employee</th>
                                <th>Position</th>
                                <th>Target</th>
                                <th>Current</th>
                                <th>Achievement %</th>
                                <th>Status</th>
                                <th width="120">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="10" class="text-center">Loading KPIs...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modals Container -->
<div id="page-modals"></div>

<script src="assets/js/kpi_crud.html"></script>
